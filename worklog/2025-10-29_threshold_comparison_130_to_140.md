# Threshold 비교: b=130 ~ 140

**작성일**: 2025-10-29
**테스트 범위**: b=130, 132, 135, 140

---

## 전체 비교표

### test_small.jpg (1443 x 1082)

| Threshold | Coverage | 구멍 개수 | 총 손상 면적 | 평가 |
|-----------|----------|----------|-------------|------|
| **b=130** | 5.29% | 61개 | 77,347 px (4.95%) | ❌ 너무 적음 |
| **b=132** | 18.45% | 401개 | 127,986 px (8.20%) | ⚠️ 많음 |
| **b=135** | 31.43% | 241개 | 18,026 px (1.15%) | ✅ 적당 |
| **b=140** | 32.91% | 258개 | 27,580 px (1.77%) | ✅ 적당 |

### w_0005.tif (7216 x 5412)

| Threshold | Coverage | 구멍 개수 | 총 손상 면적 | 평가 |
|-----------|----------|----------|-------------|------|
| **b=130** | 6.57% | 6,287개 | 538,538 px (1.38%) | ❌ 너무 많음 |
| **b=132** | 12.60% | 1,505개 | 398,508 px (1.02%) | ⚠️ 많음 |
| **b=135** | 15.38% | 249개 | 217,244 px (0.56%) | ✅ **가장 적당** |
| **b=140** | 16.20% | 877개 | 297,018 px (0.76%) | ✅ 적당 |

---

## Threshold별 상세 분석

### b=130 (매우 엄격)

**특징**: 거의 순백색만 검출

**test_small**:
- Coverage: 5.29% (매우 낮음)
- 구멍: 61개 (너무 적음)
- 평가: ❌ 대부분의 구멍을 놓침

**w_0005**:
- Coverage: 6.57%
- 구멍: 6,287개 (너무 많음)
- 평가: ❌ 미세한 노이즈까지 다 검출

**결론**: 너무 엄격해서 실용성 낮음

---

### b=132 (엄격)

**특징**: 흰색 + 아주 약간 노란색

**test_small**:
- Coverage: 18.45%
- 구멍: 401개
- 평가: ⚠️ b=135(241개)보다 많음

**w_0005**:
- Coverage: 12.60%
- 구멍: 1,505개
- 평가: ⚠️ b=135(249개)보다 훨씬 많음

**결론**: w_0005에서는 약간 과검출

---

### b=135 (균형) ⭐

**특징**: 흰색 + 약간 노란색

**test_small**:
- Coverage: 31.43%
- 구멍: 241개
- 평가: ✅ 적당

**w_0005**:
- Coverage: 15.38%
- 구멍: 249개
- 평가: ✅ **가장 적당** (b=140보다 3.5배 적음)

**결론**: w_0005에서 가장 깔끔한 결과

---

### b=140 (관대)

**특징**: 흰색 + 노란색까지 포함

**test_small**:
- Coverage: 32.91%
- 구멍: 258개
- 평가: ✅ 적당

**w_0005**:
- Coverage: 16.20%
- 구멍: 877개
- 평가: ✅ 적당하지만 b=135보다 많음

**결론**: test_small에는 좋지만 w_0005에서는 약간 많음

---

## 이미지별 특성 차이

### test_small.jpg (평균 b=141.7)
- 배경이 비교적 깨끗
- b=135 ~ b=140 모두 비슷한 결과 (241~258개)
- Coverage 차이: 31.43% → 32.91% (1.5% 차이)

**권장**: b=135 또는 b=140 (큰 차이 없음)

### w_0005.tif (평균 b=144.1)
- 배경이 더 얼룩지고 노란색
- b값에 매우 민감하게 반응
- 구멍 개수 변화:
  - b=130: 6,287개 (너무 많음)
  - b=132: 1,505개
  - b=135: **249개** ⭐
  - b=140: 877개

**권장**: **b=135** (가장 깔끔)

---

## 최종 권장 사항

### Option 1: b=135 (균형잡힌 선택) ⭐

```bash
python extract_whiteness_based.py \
  --method lab_b \
  --s-threshold 135 \
  --min-area 10
```

**장점**:
- ✅ test_small: 241개 (적당)
- ✅ w_0005: **249개** (매우 깔끔)
- ✅ 두 이미지 모두 비슷한 개수 (일관성)
- ✅ 과검출 최소화

**단점**:
- ⚠️ 약간 노란 구멍은 놓칠 수 있음

---

### Option 2: b=140 (좀 더 포괄적)

```bash
python extract_whiteness_based.py \
  --method lab_b \
  --s-threshold 140 \
  --min-area 10
```

**장점**:
- ✅ test_small: 258개 (적당)
- ✅ w_0005: 877개 (포괄적)
- ✅ 약간 노란 구멍도 포함

**단점**:
- ⚠️ w_0005에서 b=135보다 3.5배 많음

---

## 비교 그래프 (구멍 개수)

```
test_small (61 ~ 401개)
b=130: ████                              61개
b=132: ████████████████████████████   401개
b=135: █████████████                  241개
b=140: █████████████▌                 258개

w_0005 (249 ~ 6,287개)
b=130: ████████████████████████████ 6,287개
b=132: ███████                       1,505개
b=135: █                               249개 ⭐
b=140: ████                            877개
```

---

## 결론

### 최종 추천: **b=135** ⭐

**이유**:
1. test_small과 w_0005 모두에서 비슷한 개수 (241개 vs 249개)
2. w_0005에서 과검출 최소화 (b=140의 877개 대비 71% 감소)
3. 일관성 높음
4. 진짜 구멍만 정확히 검출

**사용 예시**:
```bash
python extract_whiteness_based.py \
  --input "your_image.jpg" \
  --output-dir results/output \
  --method lab_b \
  --s-threshold 135 \
  --min-area 10
```

---

## 출력 위치

- `results/test_small_b135/` - 241개 구멍
- `results/w_0005_b135/` - 249개 구멍
- `results/test_small_b140/` - 258개 구멍
- `results/w_0005_b140/` - 877개 구멍
