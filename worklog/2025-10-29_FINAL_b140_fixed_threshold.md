# ìµœì¢… íŒŒë¼ë¯¸í„°: ê³ ì • b=140

**ì‘ì„±ì¼**: 2025-10-29
**ìµœì¢… ê²°ì •**: ìë™ threshold ëŒ€ì‹  **ê³ ì • b=140** ì‚¬ìš©

---

## ìµœì¢… ê¶Œì¥ íŒŒë¼ë¯¸í„°

```bash
python extract_whiteness_based.py \
  --method lab_b \
  --s-threshold 140 \
  --min-area 10
```

### í•µì‹¬ ì„¤ì •
- **method**: `lab_b` (LAB b-channel ë‹¨ë…)
- **s-threshold**: `140` (ê³ ì •ê°’, percentile ì‚¬ìš© ì•ˆ í•¨)
- **min-area**: `10` (ìµœì†Œ êµ¬ë© í¬ê¸°)
- **ì •ë ¬**: yì¢Œí‘œ ì—­ìˆœ (ì•„ë˜â†’ìœ„)

---

## ê²°ê³¼ ë¹„êµ (b=140 ê³ ì •ê°’)

### test_small.jpg (1443 x 1082)

**ì¶œë ¥**: `results/test_small_fixed_b140/`

**í†µê³„**:
- **b threshold**: < 140 (absolute, ê³ ì •)
- **White coverage**: 32.91%
- **ì´ ìœ¤ê³½ì„ **: 267ê°œ
- **ê²€ì¶œ êµ¬ë©**: 258ê°œ
- **ì œì™¸ë¨**: 9ê°œ
- **ë©´ì  ë²”ìœ„**: 10 - 2,694 pixels
- **í‰ê·  ë©´ì **: 106.9 pixels
- **ì¤‘ê°„ê°’ ë©´ì **: 62.2 pixels
- **ì´ ì†ìƒ**: 27,580 pixels (1.77%)

---

### w_0005.tif (7216 x 5412)

**ì¶œë ¥**: `results/w_0005_fixed_b140/`

**í†µê³„**:
- **b threshold**: < 140 (absolute, ê³ ì •)
- **White coverage**: 16.20%
- **ì´ ìœ¤ê³½ì„ **: 2,304ê°œ
- **ê²€ì¶œ êµ¬ë©**: 877ê°œ
- **ì œì™¸ë¨**: 1,427ê°œ
- **ë©´ì  ë²”ìœ„**: 10 - 18,569 pixels
- **í‰ê·  ë©´ì **: 338.7 pixels
- **ì¤‘ê°„ê°’ ë©´ì **: 24.5 pixels
- **ì´ ì†ìƒ**: 297,018 pixels (0.76%)

---

## ìë™ vs ê³ ì • ë¹„êµ

### test_small.jpg

| Threshold | êµ¬ë© ê°œìˆ˜ | Coverage | íŒì • |
|-----------|----------|----------|------|
| ìë™ (p33â†’b=140) | 258ê°œ | 32.91% | - |
| **ê³ ì • b=140** | **258ê°œ** | **32.91%** | âœ… **ë™ì¼** |

### w_0005.tif

| Threshold | êµ¬ë© ê°œìˆ˜ | Coverage | íŒì • |
|-----------|----------|----------|------|
| ìë™ (p33â†’b=144) | 18,920ê°œ | 26.64% | âš ï¸ ë„ˆë¬´ ë§ìŒ |
| **ê³ ì • b=140** | **877ê°œ** | **16.20%** | âœ… **í›¨ì”¬ ì¢‹ìŒ** |

**ê²°ë¡ **: w_0005ì—ì„œ ìë™ thresholdê°€ 18,920ê°œë¥¼ ê²€ì¶œí–ˆì§€ë§Œ,
**ê³ ì • b=140ìœ¼ë¡œ 877ê°œë§Œ ê²€ì¶œí•˜ëŠ” ê²ƒì´ ì‹¤ì œ êµ¬ë©ì— í›¨ì”¬ ê°€ê¹Œì›€**.

---

## b=140ì˜ ë¬¼ë¦¬ì  ì˜ë¯¸

### LAB b-channel ê¸°ì¤€
- **b < 128**: íŒŒë€ìƒ‰ ê³„ì—´
- **b = 128**: ì¤‘ë¦½ (íšŒìƒ‰)
- **b > 128**: ë…¸ë€ìƒ‰ ê³„ì—´

### b=140 threshold
```
b < 140: í°ìƒ‰ ~ ì•½ê°„ ë…¸ë€ ì •ë„ â†’ êµ¬ë©ìœ¼ë¡œ íŒë‹¨
b â‰¥ 140: ë…¸ë€ìƒ‰ (ë² ì´ì§€) â†’ ì¢…ì´ ì–¼ë£©ìœ¼ë¡œ íŒë‹¨
```

**ì˜ë¯¸**:
- ì§„ì§œ êµ¬ë© (í°ìƒ‰/ì•½ê°„ ë…¸ë€ìƒ‰)ë§Œ ê²€ì¶œ
- ì¢…ì´ ì–¼ë£© (ë² ì´ì§€ìƒ‰)ì€ ì œì™¸
- **ì—„ê²©í•œ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•œ êµ¬ë©ë§Œ ì¶”ì¶œ**

---

## ì™œ ê³ ì • b=140ì´ ë” ì¢‹ì€ê°€?

### 1. ì¼ê´€ì„±
- ëª¨ë“  ì´ë¯¸ì§€ì— **ë™ì¼í•œ ê¸°ì¤€** ì ìš©
- ì´ë¯¸ì§€ê°€ ë‹¬ë¼ì ¸ë„ thresholdëŠ” í•­ìƒ 140

### 2. ì¬í˜„ì„±
- ì–¸ì œ ì‹¤í–‰í•´ë„ **ê°™ì€ ê²°ê³¼**
- ë‹¤ë¥¸ ì‚¬ëŒì´ ì‹¤í–‰í•´ë„ ë™ì¼

### 3. ë¬¼ë¦¬ì  ì˜ë¯¸ ëª…í™•
- "b=140 ë¯¸ë§Œì€ êµ¬ë©"ì´ë¼ëŠ” **ëª…í™•í•œ ì •ì˜**
- percentileì€ ì´ë¯¸ì§€ë§ˆë‹¤ ì˜ë¯¸ê°€ ë‹¬ë¼ì§

### 4. ê³¼ê²€ì¶œ ë°©ì§€
- ìë™ thresholdëŠ” ì´ë¯¸ì§€ ìƒ‰ìƒì— ë”°ë¼ ë„ˆë¬´ ë§ì´ ê²€ì¶œí•  ìˆ˜ ìˆìŒ
- w_0005: 18,920ê°œ(ìë™) â†’ 877ê°œ(ê³ ì •) = **21ë°° ê°ì†Œ**

### 5. ì‹¤ì œ êµ¬ë©ì— ë” ê°€ê¹Œì›€
- ì–¼ë£©ì§€ê³  ë³€ìƒ‰ëœ ë¶€ë¶„ì„ êµ¬ë©ìœ¼ë¡œ ì˜¤íŒí•˜ì§€ ì•ŠìŒ
- **ì§„ì§œ êµ¬ë© (í°ìƒ‰)ë§Œ ì •í™•íˆ ê²€ì¶œ**

---

## ì‚¬ìš© ì˜ˆì‹œ

### ë‹¨ì¼ ì´ë¯¸ì§€ ì²˜ë¦¬
```bash
python extract_whiteness_based.py \
  --input "datasets/test_small.jpg" \
  --output-dir results/output \
  --method lab_b \
  --s-threshold 140 \
  --min-area 10
```

### ë°°ì¹˜ ì²˜ë¦¬ (ì—¬ëŸ¬ ì´ë¯¸ì§€)
```bash
# ëª¨ë“  .tif íŒŒì¼ì— ë™ì¼í•œ ê¸°ì¤€ ì ìš©
for img in datasets/1ì²©/*.tif; do
    name=$(basename "$img" .tif)
    python extract_whiteness_based.py \
      --input "$img" \
      --output-dir "results/${name}_b140" \
      --method lab_b \
      --s-threshold 140 \
      --min-area 10
done
```

---

## íŒŒë¼ë¯¸í„° ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš°

### ë” ë§ì´ ê²€ì¶œí•˜ê³  ì‹¶ë‹¤ë©´ (í•´ì§„ ë¶€ë¶„ë„ í¬í•¨)
```bash
--s-threshold 145  # ë˜ëŠ” 150
```
- b=145: ì•½ê°„ ë” ë…¸ë€ ë¶€ë¶„ê¹Œì§€ í¬í•¨
- b=150: ë² ì´ì§€ìƒ‰ì— ê°€ê¹Œìš´ ë¶€ë¶„ë„ í¬í•¨

### ë” ì ê²Œ ê²€ì¶œí•˜ê³  ì‹¶ë‹¤ë©´ (ì§„ì§œ êµ¬ë©ë§Œ)
```bash
--s-threshold 135  # ë˜ëŠ” 130
```
- b=135: ê±°ì˜ ìˆœë°±ìƒ‰ë§Œ
- b=130: ì™„ì „ í°ìƒ‰ë§Œ

### ê¶Œì¥ ë²”ìœ„
```
b=130~145
```
- 130: ë§¤ìš° ì—„ê²© (ìˆœë°±ìƒ‰ë§Œ)
- 140: **ê¶Œì¥ê°’** (í°ìƒ‰~ì•½ê°„ ë…¸ë€ìƒ‰)
- 145: ê´€ëŒ€í•¨ (ë…¸ë€ìƒ‰ê¹Œì§€)

---

## ìµœì¢… ì¶œë ¥ ìœ„ì¹˜

### test_small.jpg
```
results/test_small_fixed_b140/
â”œâ”€â”€ comparison.png          # 258ê°œ êµ¬ë© í‘œì‹œ
â”œâ”€â”€ white_mask.png          # 32.91% coverage
â””â”€â”€ individual_holes/       # 258ê°œ ê°œë³„ ì´ë¯¸ì§€
```

### w_0005.tif
```
results/w_0005_fixed_b140/
â”œâ”€â”€ comparison.png          # 877ê°œ êµ¬ë© í‘œì‹œ
â”œâ”€â”€ white_mask.png          # 16.20% coverage
â””â”€â”€ individual_holes/       # 877ê°œ ê°œë³„ ì´ë¯¸ì§€
```

---

## í•µì‹¬ ê°œì„  ì‚¬í•­

### 1. extract_whiteness_based.py ìˆ˜ì •
**Line 366-370**: yì¢Œí‘œ ì—­ìˆœ ì •ë ¬ ì¶”ê°€
```python
# yì¢Œí‘œ ì—­ìˆœ ì •ë ¬ (ì•„ë˜â†’ìœ„)
holes = sorted(holes, key=lambda h: h['bbox'][1], reverse=True)
# ID ì¬í• ë‹¹
for i, hole in enumerate(holes):
    hole['id'] = i
```

### 2. ê³ ì • threshold ì‚¬ìš©
```python
# ìë™ (ì‚¬ìš© ì•ˆ í•¨)
--s-percentile 33

# ê³ ì • (ìµœì¢… ê¶Œì¥)
--s-threshold 140
```

---

## ê²°ë¡ 

**ìµœì¢… ê¶Œì¥ íŒŒë¼ë¯¸í„°**:
```bash
--method lab_b --s-threshold 140 --min-area 10
```

**ì¥ì **:
- âœ… ì¼ê´€ì„±: ëª¨ë“  ì´ë¯¸ì§€ì— ë™ì¼í•œ ê¸°ì¤€
- âœ… ì¬í˜„ì„±: í•­ìƒ ê°™ì€ ê²°ê³¼
- âœ… ì •í™•ì„±: ì§„ì§œ êµ¬ë©ë§Œ ê²€ì¶œ (ê³¼ê²€ì¶œ ë°©ì§€)
- âœ… ëª…í™•ì„±: ë¬¼ë¦¬ì  ì˜ë¯¸ê°€ ëª…í™• (b<140=í°ìƒ‰)
- âœ… ì‹¤ìš©ì„±: 877ê°œ (w_0005) vs 18,920ê°œ (ìë™) = 21ë°° ê°ì†Œ

**ì´ íŒŒë¼ë¯¸í„°ë¡œ ëª¨ë“  ë¬¸ì„œë¥¼ ì¼ê´€ë˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.** ğŸ¯
